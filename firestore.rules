rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {

    // Permitir lectura global
    match /{document=**} {
      allow read: if true;
    }

    // ðŸ”¹ Eventos
    match /eventos/{eventoId} {
      allow read: if true; // todos pueden ver eventos
      allow create, update, delete: if request.auth != null; // solo usuarios autenticados

      // ðŸ”¸ Comentarios de evento
      match /comentarios/{comentarioId} {
        // solo usuarios logueados pueden comentar
        allow create: if request.auth != null
                      && request.resource.data.usuarioId == request.auth.uid;

        // solo el autor puede editar o borrar su comentario
        allow update, delete: if request.auth != null
                              && resource.data.usuarioId == request.auth.uid;

        allow read: if true;
      }

      // ðŸ”¸ Calificaciones (solo el usuario puede escribir su propia)
      match /calificaciones/{userId} {
        allow create, update, delete: if request.auth != null
                                      && request.auth.uid == userId;
        allow read: if true;
      }

      // ðŸ”¸ Favoritos (solo el usuario puede modificar su registro)
      match /favoritos/{userId} {
        allow create, update, delete: if request.auth != null
                                      && request.auth.uid == userId;
        allow read: if request.auth != null;
      }
    }
  }
}
